<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>
        首页
    </title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="./css/x-admin.css" media="all">
    <link rel="stylesheet" href="./lib/bootstrap/css/bootstrap.css" media="all" />
    <link rel="stylesheet" type="text/css" href="http://at.alicdn.com/t/font_3372454_27mp59jqcbr.css">
    <style type="text/css">
        legend { display: block; width:100px; border-bottom:0px; font-family: "Microsoft YaHei","Helvetica Neue";}
        legend a{ color:#666;} legend a:hover{ text-decoration:none;}
        .layui-table{ font-family: "Microsoft YaHei","Helvetica Neue";}
    
    .time span{display:inline-block;width:40px;height: 20px;}
    body{background:url(images/inspector.jpg);background-size:cover;overflow:hidden}
        
    </style>
</head>
<body>
    
<div class="x-nav">
            <span class="layui-breadcrumb">
              <a><cite>首页</cite></a>
            </span>
    <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right"  href="javascript:location.replace(location.href);" title="刷新"><i class="layui-icon" style="line-height:30px">ဂ</i></a>
</div>
<div class="x-body">
    <blockquote class="layui-elem-quote">
        <span>登录时间：<div class="layui-nav-item" id="time" style="margin-right: 50px;font-size: 15px;color: #1a93ef;"></div></span>
            <div class="layui-nav-item" id="time" style="margin-right: 50px;font-size: 15px;color: #1a93ef;"></div>
        <sapn>admin</sapn>欢迎使用后台管理系统！
    </blockquote>
    <form class="layui-form x-center" action="" style="width:800px">
        <div class="layui-form-pane" style="margin-top: 15px;">
            <div class="layui-form-item">
                <label class="layui-form-label">检测到虫</label>
                <div class="layui-input-inline">
                    <input class="layui-input" placeholder="树木ID" id="treeid">
                </div>
                <div class="layui-input-inline" style="width:80px">
                    <button class="layui-btn"  lay-submit="" lay-filter="sreach" onclick="savetree(form)"><i class="iconfont">&#xeb2c;</i></button>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">检测到坑洼</label>
                <div class="layui-input-inline">
                    <input class="layui-input" placeholder="道路ID" id="roadid" >
                </div>
                <div class="layui-input-inline" style="width:80px">
                    <button class="layui-btn"  lay-submit="" lay-filter="sreach" onclick="savekeng(form)"><i class="iconfont">&#xeb2c;</i></button>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">待清理厕所</label>
                <div class="layui-input-inline">
                    <input class="layui-input" placeholder="厕所ID" id="toiletid">
                </div>
                <div class="layui-input-inline" style="width:80px">
                    <button class="layui-btn"  lay-submit="" lay-filter="sreach" onclick="savetoilet(form)"><i class="iconfont">&#xeb2c;</i></button>
                </div>
            </div>
        </div>
    </form>
</div>

<script src="./lib/layui/layui.js" charset="utf-8"></script>
<script src="./js/x-admin.js"></script>
<script src="./js/jquery.min.js"></script>
<script src="./js/x-layui.js" charset="utf-8"></script>
<script>
    //顶部时间
    var flag=true;
    function getTime(){
        
        var myDate = new Date();
        var myYear = myDate.getFullYear(); //获取完整的年份(4位,1970-????)
        var myMonth = myDate.getMonth()+1; //获取当前月份(0-11,0代表1月)
        var myToday = myDate.getDate(); //获取当前日(1-31)
        var myDay = myDate.getDay(); //获取当前星期X(0-6,0代表星期天)
        var myHour = myDate.getHours(); //获取当前小时数(0-23)
        var myMinute = myDate.getMinutes(); //获取当前分钟数(0-59)
        var mySecond = myDate.getSeconds(); //获取当前秒数(0-59)
        var week = ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'];
        var nowTime;

        nowTime = myYear+'-'+fillZero(myMonth)+'-'+fillZero(myToday)+'&nbsp;&nbsp;'+fillZero(myHour)+':'+fillZero(myMinute)+':'+fillZero(mySecond)+'&nbsp;&nbsp;'+week[myDay]+'&nbsp;&nbsp;';
        //console.log(nowTime);
        $('#time').html(nowTime);
        
    };
    function fillZero(str){
        var realNum;
        if(str<10){
            realNum	= '0'+str;
        }else{
            realNum	= str;
        }
        return realNum;
    }
    if(flag)
    {
        getTime();
    }
</script>
<script>
    function savetree(frm){
            alert("已成功提交树木虫子状态！");
            var jsonObject=new Object();
            jsonObject.treeid=frm.treeid.value;
            //alert(frm.treeid.value);
            var stringData=JSON.stringify(jsonObject);
            var xhr = new XMLHttpRequest();
            xhr.withCredentials = true;
             xhr.addEventListener("readystatechange", function() {
                if(this.readyState === 4) {
                       console.log(this.responseText);
                       alert(this.responseText);
                }
           });
           xhr.open("PUT", "http://192.168.50.65:8000/killinsects/");
           xhr.send(stringData);
          
    }
    function savekeng(frm){
            alert("已成功提交道路有坑洼数据！");
            var jsonObject=new Object();
            jsonObject.roadid=frm.roadid.value;
            //alert(frm.treeid.value);
            var stringData=JSON.stringify(jsonObject);
            var xhr = new XMLHttpRequest();
            xhr.withCredentials = true;
             xhr.addEventListener("readystatechange", function() {
                if(this.readyState === 4) {
                       console.log(this.responseText);
                       alert("inputok!");
                }
           });
           xhr.open("DELETE", "http://192.168.50.65:8000/roadmain/");
           xhr.send(stringData);
          
    }

    function savetoilet(frm){
            alert("已成功将该厕所设置为需清扫状态！");
            var jsonObject=new Object();
            jsonObject.toiletid=frm.toiletid.value;
            //alert(frm.treeid.value);
            var stringData=JSON.stringify(jsonObject);
            var xhr = new XMLHttpRequest();
            xhr.withCredentials = true;
             xhr.addEventListener("readystatechange", function() {
                if(this.readyState === 4) {
                       console.log(this.responseText);
                       alert("clean ok!");
                }
           });
           xhr.open("PUT", "http://192.168.50.65:8000/wcclean/");
           xhr.send(stringData);
          
    }

</script>

</body>
</html>