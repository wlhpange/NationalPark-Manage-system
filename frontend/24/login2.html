<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>管理员登录</title>
    <link rel="stylesheet" href="css/login2.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script src="./lib/layui/layui.js" charset="utf-8"></script>

</head>

<body class="login-bg">
    <div class="biaoti">
        军都山公园管理员系统
    </div>
    <div class="login">
        <div class="message">管理员登陆</div>
        <div id="darkbannerwrap"></div>
        <form method="post" class="layui-form">
            <input name="mid" placeholder="用户名" type="text" lay-verify="required" class="layui-input">
            <hr class="hr15">
            <input name="mpw" lay-verify="required" placeholder="请输入8位密码" type="password" class="layui-input">
            <hr class="hr15">
            <input value="登录" lay-submit lay-filter="login" style="width:100%;" type="button" onclick="test(this.form)">
            <hr class="hr20">
        </form>
    </div>

    <script>
        function test(frm) {
            alert("hh");
            var stringdata = frm.mid.value;
            var storage = window.localStorage;
            storage.setItem("name", stringdata);
            console.log(storage);
            //location.href="./index.html";



            var jsonObject = new Object();
            jsonObject.mid = frm.mid.value;
            jsonObject.mpw = frm.mpw.value;
            var stringData = JSON.stringify(jsonObject);
            var xhr = new XMLHttpRequest();
            xhr.withCredentials = true;
            xhr.addEventListener("readystatechange", function () {
                if (this.readyState === 4) {
                    console.log(this.responseText);
                    if (this.responseText == "defeat") {
                        alert("账户名或密码错误！");
                        location.reload();
                    } else {
                        alert("login success!");
                        location.href = "./index.html";
                    }
                }
            });
            xhr.open("POST", "http://192.168.50.65:8000/adminlogin/");
            xhr.send(stringData);
            
        }
    </script>


    <!-- 底部结束 -->

</body>

</html>